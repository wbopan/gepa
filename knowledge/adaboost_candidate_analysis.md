# AdaBoost Run 候选者分析研究报告

> 研究日期: 2026-02-01
> 数据来源: WandB bmpixel/gepa-boost 项目，adaboost run (id: 51nvyulu)

## 1. 研究背景与目标

### 1.1 研究问题
1. 高性能候选者和低性能候选者在 prompt 文本上有什么区别？
2. **核心假设验证**: 优秀子代的父代是否往往是当时最优秀的 prompt？如果只从最优 prompt 变异，能否更快更好地达到结果？

### 1.2 数据概览
| 指标 | 值 |
|------|-----|
| 总候选者数量 | 37 |
| 最佳分数 | 0.800 (候选者 #5) |
| 最差分数 | 0.133 (候选者 #2) |
| 平均分数 | 0.623 |
| 总评估调用次数 | 2,000 |

---

## 2. 高性能 vs 低性能候选者对比

### 2.1 分数分布
| 分类 | 候选者数量 | 比例 |
|------|-----------|------|
| 最佳 (>0.75) | 1 | 2.7% |
| 高分 (0.6-0.75) | 27 | 73.0% |
| 中等 (0.4-0.6) | 4 | 10.8% |
| 低分 (≤0.4) | 5 | 13.5% |

### 2.2 结构特征对比
| 特征 | 高性能 (≥0.7) | 低性能 (<0.5) |
|------|--------------|---------------|
| 平均长度 | 8,025 字符 | 4,421 字符 |
| 平均加粗段落数 | 39.3 | 28.6 |
| 平均要点数 | 41.4 | 17.8 |

**发现**: 高性能候选者平均长度是低性能的 **1.8倍**，结构化程度更高。

### 2.3 领域知识覆盖率
| 知识点 | 高性能覆盖率 | 低性能覆盖率 |
|--------|-------------|--------------|
| Maxwell 方程 | 68.8% | 20.0% |
| 自旋-1/2 本征态 | 68.8% | 20.0% |
| 谐振子 | 68.8% | 20.0% |
| 上位性分析 (epistasis) | 68.8% | 60.0% |
| "Key requirements" 章节 | **75.0%** | **0.0%** |
| Step-by-step 思维 | 100% | 60.0% |
| 陷阱警告 (pitfalls) | 93.8% | 80.0% |

### 2.4 最优候选者 (idx=5) 的关键特点
- 长度: 5,363 字符
- 包含 25 个加粗章节和 35 个要点
- 包含 "Key requirements" 章节
- 覆盖所有核心物理/化学/生物知识点
- 明确的 "Final output" 格式要求
- 包含 "dimensional check" 和 "unit check" 提示

---

## 3. 假设验证: 只从最优变异能否更快达到结果？

### 3.1 研究设计
- **假设**: 优秀子代的父代往往是当时最优秀的 prompt，只从最优变异可以更快更好达到结果
- **方法**: 对每个变异，判断其父代是否为当时最优，并与子代分数进行统计分析
- **注意**: 排除早期阶段（可用候选者<4），专注于后期有足够候选者分化后的情况

### 3.2 统计检验结果

#### 全样本分析 (n=37)
| 检验方法 | 结果 | 结论 |
|---------|------|------|
| Pearson 相关系数 | r = +0.356 | 弱正相关 |
| p-value | 0.024 | 显著 (p<0.05) |
| R² | 12.7% | 父代分数解释了约13%的子代分数变异 |

#### 后期阶段分析 (n=33, 可用候选者≥4)
| 检验方法 | 结果 | 结论 |
|---------|------|------|
| Pearson 相关系数 | r = **-0.179** | 弱负相关! |
| p-value | 0.312 | 不显著 |
| R² | 3.2% | 几乎无解释力 |
| Mann-Whitney U | p = 0.450 | 不显著 |
| Cohen's d | 0.108 | 微小效应 |
| Fisher精确检验 | p = 0.493 | 不显著 |

### 3.3 辛普森悖论 (Simpson's Paradox)
**重要发现**: 全样本显示正相关，但后期阶段显示负相关！

原因分析:
- 早期只有 seed (idx=0, 分数=0.4) 作为父代
- seed 产生的子代分数差异很大: 0.133 到 0.700
- 这造成了"低分父代→低/高分子代"的数据，驱动了整体正相关
- 排除早期后，相关性消失甚至反转

### 3.4 后期阶段按父代分数分组
| 父代分数 | 变异次数 | 子代均分 | 高分率(≥0.7) |
|---------|---------|---------|-------------|
| 0.800 (最优) | 18 | 0.650 | 39% |
| 0.733 | 5 | 0.533 | 20% |
| 0.700 | 2 | 0.650 | 50% |
| 0.633 | 6 | **0.706** | **83%** ← 最高! |
| 0.600 | 1 | 0.733 | 100% |

**关键发现**: 从 0.633 分父代变异的子代高分率(83%)远超从最优父代(0.8)变异的高分率(39%)！

### 3.5 Bootstrap 置信区间
子代平均分数的 95% 置信区间:
- 从最优父代: [0.605, 0.679]
- 从非最优父代: [0.509, 0.691]
- 差值 95% CI: [-0.05, 0.14] (包含 0)

---

## 4. 进化路径分析

### 4.1 最优解的进化路径
```
0 (0.40) → 3 (0.70) → 5 (0.80)
```

关键步骤分析:
- **0 → 3**: 父代(0)不是当时最优，当时最优是候选者 1 (0.53)
- **3 → 5**: 父代(3)是当时最优

**如果采用"只从最优变异"策略**:
- ❌ 候选者 3 不会产生（因为当时最优是 1，不是 0）
- ❌ 候选者 5 (全局最优) 不会产生
- ❌ 最终结果被限制在 ~0.53 分

### 4.2 父代生育力统计
| 父代 | 子代数 | 子代平均分 | 子代分数范围 |
|------|-------|----------|-------------|
| 5 (0.800) | 18 | 0.650 | 0.400-0.733 |
| 28 (0.733) | 3 | 0.433 | 0.333-0.633 |
| 29 (0.633) | 4 | 0.708 | 0.700-0.733 |
| 17 (0.633) | 2 | 0.700 | 0.667-0.733 |

---

## 5. Prompt 文本内容分析

### 5.1 失败变异的具体问题
以候选者 7 (从最优父代 5 变异，分数从 0.8 下降到 0.4) 为例:

**丢失的关键短语**:
| 短语 | 父代 5 | 子代 7 |
|-----|--------|--------|
| "reason step-by-step" | ✓ | ✗ 丢失 |
| "Key requirements" | ✓ | ✗ 丢失 |
| "Your final output must contain only" | ✓ | ✗ 丢失 |
| "Eliminate obviously wrong options" | ✓ | ✗ 丢失 |
| "Cross-check with known limits" | ✓ | ✗ 丢失 |
| "Unit and dimensional checks" | ✓ | ✗ 丢失 |

### 5.2 成功变异 vs 失败变异的模式
| 变异类型 | 样本数 | 长度变化 | 特点 |
|---------|-------|---------|------|
| 成功 (≥0.7) | 7 | **+72%** | 添加内容，保留核心 |
| 中等 (0.5-0.7) | 10 | +45% | 添加较多内容 |
| 失败 (<0.5) | 1 | +16% | **重组结构**，丢失关键内容 |

### 5.3 候选者 5 的子代详细分析
| 子代 | 分数 | 长度 | 加粗 | 要点 | 长度变化 |
|-----|------|------|------|------|---------|
| 23 | 0.733 | 9988 | 41 | 62 | +86.2% |
| 27 | 0.733 | 9245 | 46 | 49 | +72.4% |
| 28 | 0.733 | 8541 | 35 | 45 | +59.3% |
| 9 | 0.700 | 8085 | 28 | 43 | +50.8% |
| 7 | 0.400 | 6230 | 41 | 20 | +16.2% |

**规律**: 成功变异倾向于累加内容；失败变异倾向于重组结构

---

## 6. 核心结论

### 6.1 假设验证结果
**假设被拒绝**: 只从最优父代变异不能更快更好地达到结果。

### 6.2 统计证据汇总
| 检验 | 全样本 (n=37) | 后期 (n=33) |
|-----|--------------|-------------|
| Pearson r | +0.356 | **-0.179** |
| p-value | 0.024 (显著) | 0.312 (不显著) |
| R² | 12.7% | 3.2% |
| 结论 | 正相关 | 无相关/弱负相关 |

### 6.3 原因分析

#### 1. 局部最优陷阱 (Local Optimum Trap)
- 候选者 5 已达到性能高峰
- 包含针对验证集问题的"精确知识"
- 任何修改都倾向于破坏这些精确匹配
- 结果: 18 个子代，0 个超越 0.80 分

#### 2. 变异的"噪声"效应
- 成功变异: 添加内容 (+50%~+90% 长度)，保留核心结构
- 失败变异: 重组结构，丢失关键短语如 "reason step-by-step"
- LLM 变异倾向于重写而非增量修改

#### 3. 过拟合风险
- 候选者 5 已经"过拟合"到验证集的特定问题
- 子代即使添加新内容，也难以找到新的正确答案
- 添加错误信息反而可能丢分

#### 4. 低分父代的优势
- 有更大的"改进空间"
- 变异可以补充缺失的关键知识
- 不会被"精确但脆弱"的知识束缚
- 结构更灵活，可接受新组织方式

### 6.4 Exploration-Exploitation 权衡
这是一个典型的 exploration-exploitation 困境:
- 最优候选者代表了对当前问题集的最佳 **exploitation**
- 继续 exploit 它反而限制了 **exploration** 的可能性
- 保持种群多样性对于持续优化至关重要

---

## 7. 建议

1. **不建议采用"只从最优变异"策略**
   - 当前允许从多个候选者变异的策略对发现全局最优是必要的

2. **变异策略优化方向**
   - 倾向于累加内容而非重组结构
   - 保护关键推理指令（如 "step-by-step"）
   - 在添加领域知识时保持核心框架不变

3. **采样策略考量**
   - 在后期阶段，可以考虑从中等分数候选者进行更多变异
   - 避免过度集中于当前最优候选者

---

## 附录 A: 题目难度分布

| 题目类型 | 题目ID | 所有候选者正确率 |
|---------|--------|-----------------|
| 最难 | 4, 29 | **0%** (无人答对) |
| 较难 | 12, 15 | 2.7% |
| 最易 | 11 | 100% |
| 较易 | 14, 26, 2, 18 | 94.5%+ |

---

## 附录 B: 补充假设 - 复杂度陷阱

### 假设
从短/简单的候选者变异更容易获得改进；如果候选者已经变得很复杂，进一步的改动可能反而会损失性能。

### 验证数据

**父代长度与子代改进的相关性**:
- Pearson r = **-0.184** (负相关)
- 解释：父代越长，子代改进越小

**按父代长度分组**:
| 父代长度 | 样本数 | 子代平均改进 | 子代均分 | 高分率 |
|---------|-------|-------------|---------|-------|
| 短 (<4k) | 5 | +0.013 | 0.533 | 40% |
| 中短 (4-6k) | 22 | -0.109 | 0.661 | 50% |
| 长 (>8k) | 6 | -0.106 | 0.572 | 33% |

**短父代 vs 长父代**:
| 指标 | 短父代 (<6k) | 长父代 (≥6k) |
|-----|-------------|-------------|
| 样本数 | 28 | 9 |
| 平均改进 | -0.069 | -0.081 |
| 子代均分 | 0.629 | 0.607 |
| 高分子代率 | **46.4%** | **33.3%** |

### 结论
数据支持此假设：
1. 父代长度与子代改进呈负相关
2. 短父代的高分子代率 (46%) 显著高于长父代 (33%)
3. 这与 Gemini 讨论中提到的"膨胀 (Bloat)"问题一致

### 相关讨论
详见 `gemini_discussion_prompt_evolution.md` 中关于：
- 局部最优陷阱
- 变异膨胀 (Mutation Bloat)
- 外科手术式变异策略
